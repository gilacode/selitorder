@import com.avicenna.security.SecUserDto
@import com.avicenna.template.TmplDto
@import views.html.helper._
@import com.avicenna.security.basic.BasicNav

@(currentUser : SecUserDto, user : SecUserDto, tmpl: TmplDto)

@if(tmpl.getNavMgr.hasPermission(BasicNav.Permission.SEC_USR_CHANGE_PWD.name(), currentUser) || currentUser.getUsername.equals(user.getUsername)) {

    <form action="@com.avicenna.security.basic.routes.BasicUserCtrl.changePassword(user.getUsername)" enctype="multipart/form-data" method="post">

        @CSRF.formField

        <div class="card">

            <div class="card-title">@Messages("profile.content.password.cardtitle")</div>

            <hr/>

            <div class="card-body">

                <div class="row">

                    <div class="form-group @tmpl.getGrid(12)">

                        <label for="currentPassword">Current Password</label>
                        <input type="password" class="form-control default-case" required="true" id="currentPassword" name="currentPassword" value="">

                    </div>

                </div>

                <div class="row">

                    <div class="form-group @tmpl.getGrid(12)">

                        <label for="newPassword">New Password</label>
                        <input type="password" class="form-control default-case" required="true" id="newPassword" name="newPassword" value="">

                    </div>

                </div>

                <div class="row">

                    <div class="form-group @tmpl.getGrid(12)">

                        <label for="confirmPassword">Confirm New Password</label>
                        <input type="password" class="form-control default-case" required="true" id="confirmPassword" name="confirmPassword" value="">

                    </div>

                </div>

                <div class="row">

                    <div class="form-group @tmpl.getGrid(12) text-center mt-1">

                        <button type="submit" class="btn btn-info">
                            <i class="icon-drawar"></i>&nbsp;Update
                        </button>

                    </div>

                </div>

            </div>

        </div>

    </form>
}